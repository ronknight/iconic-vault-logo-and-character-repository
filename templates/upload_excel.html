{% extends 'base.html' %}
{% block title %}Upload Excel · Iconic Vault{% endblock %}
{% block content %}
  <div class="panel" style="max-width:720px;margin:24px auto 0;">
    <h1 style="font-size:22px;margin:8px 0 0 0">Upload Excel File</h1>
    <p class="meta">Provide an Excel file with columns <strong>Brand</strong> and <strong>Domain</strong>. We’ll fetch logos automatically.</p>
    <form id="upload-form" action="/upload_excel" method="post" enctype="multipart/form-data">
      <div class="field" style="margin:16px 0;">
        <input class="input" type="file" name="excel_file" accept=".xlsx, .xls" required>
        <button class="btn" type="submit">Upload and Find Logos</button>
      </div>
    </form>
    <div class="progress" style="height:10px;background:#eef2ff;border-radius:8px;overflow:hidden;border:1px solid var(--border)"><div class="bar" id="bar" style="height:100%;width:0;background:#22c55e;transition:width .2s ease"></div></div>
    <div class="nav" style="margin-top:12px"><a class="link" href="{{ url_for('logos_page') }}">Back to Logos</a></div>
  </div>
{% endblock %}
{% block scripts %}
  const form = document.getElementById('upload-form');
  const bar = document.getElementById('bar');
  form && (form.onsubmit = function(){
    let pct = 0; const it = setInterval(()=>{
      pct = Math.min(100, pct + 8);
      bar.style.width = pct + '%';
      if(pct === 100) clearInterval(it);
    }, 250);
  });
{% endblock %}
